"""Production tests for common vulnerability research enums.

Tests enum validation and SeverityLevel usage.
"""

import pytest

from intellicrack.core.vulnerability_research.common_enums import SecurityRelevance
from intellicrack.utils.severity_levels import SeverityLevel


def test_security_relevance_is_severity_level() -> None:
    """Test SecurityRelevance is aliased to SeverityLevel."""
    assert SecurityRelevance is SeverityLevel


def test_severity_level_values() -> None:
    """Test SeverityLevel enum values."""
    assert hasattr(SeverityLevel, "CRITICAL")
    assert hasattr(SeverityLevel, "HIGH")
    assert hasattr(SeverityLevel, "MEDIUM")
    assert hasattr(SeverityLevel, "LOW")
    assert hasattr(SeverityLevel, "INFO")


def test_security_relevance_usage() -> None:
    """Test SecurityRelevance can be used in place of SeverityLevel."""
    critical = SecurityRelevance.CRITICAL  # type: ignore[attr-defined]
    high = SecurityRelevance.HIGH  # type: ignore[attr-defined]
    medium = SecurityRelevance.MEDIUM  # type: ignore[attr-defined]
    low = SecurityRelevance.LOW  # type: ignore[attr-defined]
    info = SecurityRelevance.INFO  # type: ignore[attr-defined]

    assert critical is SeverityLevel.CRITICAL
    assert high is SeverityLevel.HIGH
    assert medium is SeverityLevel.MEDIUM
    assert low is SeverityLevel.LOW
    assert info is SeverityLevel.INFO


def test_enum_comparison() -> None:
    """Test enum value comparison."""
    assert SecurityRelevance.CRITICAL == SeverityLevel.CRITICAL  # type: ignore[attr-defined]
    assert SecurityRelevance.HIGH != SecurityRelevance.CRITICAL  # type: ignore[attr-defined]


def test_enum_iteration() -> None:
    """Test enum can be iterated."""
    levels = list(SecurityRelevance)  # type: ignore[call-overload]
    assert len(levels) >= 5
    assert SeverityLevel.CRITICAL in levels


def test_enum_string_representation() -> None:
    """Test enum has string representation."""
    level = SecurityRelevance.HIGH  # type: ignore[attr-defined]
    assert str(level) is not None


def test_enum_value_access() -> None:
    """Test enum values can be accessed."""
    critical = SecurityRelevance.CRITICAL  # type: ignore[attr-defined]
    assert critical.name == "CRITICAL"
    assert critical.value is not None
