"""
Payload Generation Types and Constants

Shared types and enums for the payload generation system.
"""

from enum import Enum


class Architecture(Enum):
    """Supported target architectures"""
    X86 = "x86"
    X64 = "x64"
    ARM = "arm"
    ARM64 = "arm64"
    MIPS = "mips"


class PayloadType(Enum):
    """Types of payloads that can be generated"""
    REVERSE_SHELL = "reverse_shell"
    BIND_SHELL = "bind_shell"
    METERPRETER = "meterpreter"
    STAGED_PAYLOAD = "staged_payload"
    BEACON = "beacon"
    DROPPER = "dropper"
    LOADER = "loader"
    INJECTOR = "injector"
    PERSISTENCE = "persistence"
    LATERAL_MOVEMENT = "lateral_movement"
    PRIVILEGE_ESCALATION = "privilege_escalation"
    SHELLCODE = "shellcode"
    DLL_PAYLOAD = "dll_payload"
    CUSTOM = "custom"


class EncodingType(Enum):
    """Payload encoding types"""
    NONE = "none"
    XOR = "xor"
    BASE64 = "base64"
    ALPHANUMERIC = "alphanumeric"
    UNICODE = "unicode"
    ROT13 = "rot13"
    POLYMORPHIC = "polymorphic"
    METAMORPHIC = "metamorphic"
    CUSTOM = "custom"


class EvasionTechnique(Enum):
    """Anti-analysis evasion techniques"""
    NONE = "none"
    ANTI_VM = "anti_vm"
    ANTI_DEBUG = "anti_debug"
    ANTI_SANDBOX = "anti_sandbox"
    TIMING_ATTACKS = "timing_attacks"
    API_OBFUSCATION = "api_obfuscation"
    PROCESS_HOLLOWING = "process_hollowing"
    POLYMORPHIC = "polymorphic"
    METAMORPHIC = "metamorphic"
    # Dialog-compatible aliases
    VM_DETECTION = "anti_vm"
    DEBUGGER_DETECTION = "anti_debug"
    SANDBOX_DETECTION = "anti_sandbox"
    TIMING_CHECKS = "timing_attacks"
    API_HOOK_DETECTION = "api_obfuscation"


# Common payload configuration
DEFAULT_PAYLOAD_CONFIG = {
    'architecture': Architecture.X64,
    'payload_type': PayloadType.REVERSE_SHELL,
    'encoding': EncodingType.NONE,
    'evasion': [EvasionTechnique.NONE],
    'target_os': 'windows',
    'max_size': 4096,
    'avoid_chars': b'\x00\x0a\x0d',
    'include_nops': True,
    'obfuscate_api_calls': False,
    'use_encryption': False
}
