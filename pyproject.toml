[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "intellicrack"
version = "0.1.0"
authors = [
  { name="Zachary Flint", email="zach.flint2@gmail.com" },
]
description = "Intellicrack: Advanced Binary Analysis and Security Research Framework with AI-driven capabilities"
readme = "README.md"
license = { text = "GPL-3.0-or-later" }
requires-python = ">=3.10,<3.14"
keywords = ["binary-analysis", "reverse-engineering", "security", "vulnerability-detection", "malware-analysis", "ai-security", "exploit-development"]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "Intended Audience :: Information Technology",
    "Topic :: Security",
    "Topic :: Software Development :: Disassemblers",
    "Topic :: Software Development :: Debuggers",
    "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Operating System :: OS Independent",
    "Environment :: Console",
    "Environment :: X11 Applications :: Qt",
]

dependencies = [
    # Core ML/AI
    "accelerate>=0.25.0",
    "anthropic==0.54.0",
    "openai==1.90.0",
    "transformers>=4.35.0,<4.50.0",
    "huggingface_hub==0.32.0",
    "safetensors>=0.4.0",
    "peft==0.15.2",
    # "auto-gptq>=0.7.0",  # Requires NVIDIA CUDA - not compatible with Intel GPU
    "bitsandbytes>=0.41.0",
    
    # Binary Analysis
    "angr==9.2.95",
    "claripy==9.2.95",
    "capstone>=5.0.0",
    "keystone_engine==0.9.2",
    "binwalk @ https://github.com/ReFirmLabs/binwalk/archive/v2.3.4.tar.gz",
    "volatility3==2.26.0",
    "yara-python==4.5.4",
    "lief==0.16.6",
    "pefile==2024.8.26 ; sys_platform == 'win32'",
    "pyelftools==0.32",
    "z3-solver==4.10.2.0",
    "r2pipe==1.9.4",
    "frida==17.2.12",
    "frida-tools==14.4.2",
    # Emulation & Analysis
    "qiling>=1.4.6,<1.5.0",
    "python-fx @ git+https://github.com/Zachanardo/pyfx.git",  # Forked to fix typing-extensions conflict
    # Manticore - Linux/Unix only symbolic execution engine
    "manticore==0.3.7 ; sys_platform != 'win32'",
    # Native ICP Engine Integration
    "die-python<=0.4.0",
    
    # Security & Network
    "mitmproxy>=10.0.0",
    "scapy==2.6.1",
    "cryptography==44.0.3",
    "paramiko==3.5.1",
    "pyshark==0.6",
    "dpkt==1.9.8",
    "pycryptodome==3.19.0",
    "pyOpenSSL==25.0.0",
    
    # Web & HTTP
    "aiohttp==3.12.14",
    "Requests==2.32.4",
    "urllib3==2.5.0",
    "defusedxml==0.7.1",
    "boto3==1.38.41",
    "azure-storage-blob==12.19.0",
    "fastapi==0.111.0",
    "httpie>=3.2.3",
    
    "joblib==1.5.1",
    "dask[distributed]==2025.5.1",
    "ray==2.47.1",
    
    # ML Frameworks
    "tensorflow_cpu>=2.15.0,<2.20.0",
    "torch==2.7.1+cpu",
    "torchvision==0.22.1+cpu", 
    "torchaudio==2.7.1+cpu",
    # Intel extension installed separately due to uv platform issues
    "onnx==1.18.0",
    "onnxruntime==1.22.0",
    "pyopencl==2025.2.4",
    
    # Database & Storage
    "pymongo==4.13.2",
    "psycopg2_binary==2.9.10",
    
    # GUI & Visualization
    "PyQt6==6.9.1",
    "PyQt6-sip==13.10.2",
    "pyqtgraph==0.13.7",
    "Pillow==10.4.0",
    "graphviz==0.20.3",
    
    # System & Hardware
    "psutil==7.0.0",
    "pynput==1.8.1",
    "pyusb==1.3.1",
    "watchdog==6.0.0",
    "wmi==1.5.1 ; sys_platform == 'win32'",
    
    # Web & Document Processing
    "Flask==3.1.1",
    "flask_cors==6.0.1",
    "Jinja2==3.1.6",
    "pdfkit==1.0.0",
    "reportlab==4.4.1",
    "weasyprint==65.1",
    "tinycss2==1.4.0",
    "xlsxwriter==3.2.5",
    "cairocffi==1.7.1",
    
    # Data Science & Machine Learning
    "numpy",
    "pandas",
    "scipy",
    "scikit-learn",
    "matplotlib",
    "seaborn",
    "fsspec[full]>=2025.7.0",
    
    # Data Validation & APIs
    "pydantic",
    "jsonschema",
    "pyjwt",
    "pyyaml",
    "sqlalchemy",
    "uvicorn",
    
    # Development & Build
    "setuptools==80.9.0",
    "wheel==0.45.1",
    "build==1.2.1",
    "cffi==1.17.1",
    "macholib==1.16.3",
    "networkx==3.1",
    "nltk==3.9.1",
    "rich==14.0.0",
    "tqdm==4.67.1",
    
    "jiter==0.6.1",
    "importlib_metadata==6.8.0",
    "idna==3.8",
    "amqp==5.2.0",
    "kombu==5.5.2",
    "keyring==24.2.0",
    "jmespath==1.0.0",
    "hyperframe==6.0.0",
    
    # Task Management
    "celery==5.5.3",
    "click==8.1.7",
    "python-dotenv==1.0.1",
]

[project.optional-dependencies]
linux = [
    # Linux-specific symbolic execution and analysis tools
    "manticore==0.3.7",
    "unicorn==2.0.1.post1",  # CPU emulator framework - matches angr requirement
    # Additional Linux-specific tools can be added here
]

nvidia-gpu = [
    # NVIDIA GPU acceleration packages (requires CUDA)
    "cupy>=13.0.0",  # GPU arrays and CUDA support
    "torch==2.7.1+cu121",  # CUDA 12.1 enabled PyTorch
    "torchvision==0.22.1+cu121",  # CUDA 12.1 enabled torchvision
    "torchaudio==2.7.1+cu121",  # CUDA 12.1 enabled torchaudio
]

ai-local = [
    # Local AI/LLM support
    "llama-cpp-python>=0.2.0",  # Local GGUF model support
]

dev = [
    # Code Quality & Linting
    "flake8==5.0.4",
    "isort==5.13.2",
    "ruff==0.5.0",
    "bandit==1.7.8",
    "vulture==2.11",
    "pydocstyle==6.3.0",
    "mypy==1.16.0",
    "mccabe==0.7.0",
    "xenon==0.9.1",
    
    # Testing & Coverage
    "pytest==8.3.5",
    "pytest-cov==5.0.0",
    "pytest-mock==3.14.0",
    "pytest-asyncio==0.23.7",
    "pytest-xdist==3.6.1",
    "pytest-timeout==2.3.1",
    "hypothesis==6.100.0",
    "tox==4.15.0",
    "nox==2024.4.15",
    "coverage==7.8.2",
    
    # Code Metrics & Complexity
    "radon==6.0.1",
    
    # Documentation
    "sphinx==7.3.7",
    "sphinx-rtd-theme==2.0.0",
    "sphinx-autodoc-typehints==2.1.0",
    "sphinx-copybutton==0.5.2",
    "sphinx-tabs==3.4.5",
    "sphinxcontrib-mermaid==0.9.2",
    "sphinx-autobuild==2024.4.16",
    "pdoc3==0.10.0",
    "mkdocs-material==9.5.25",
    
    # Debugging & Profiling
    "ipdb==0.13.13",
    "line-profiler==4.1.2",
    "memory-profiler==0.61.0",
    "py-spy==0.3.14",
    "snakeviz==2.2.0",
    "pyinstrument==4.6.2",
    "scalene==1.5.38",
    
    # Development Utilities
    "pre-commit==3.7.1",
    "commitizen==3.27.0",
    "bumpversion==0.6.0",
    "pipdeptree==2.20.0",
    "rope==1.13.0",
    "astor==0.8.1",
    "yapf==0.40.2",
    "pip-audit==2.7.3",
    "nodeenv==1.9.1",
    "twine>=5.1.1",
    "setuptools-scm==8.1.0",
    "poetry==1.8.3",
    "pycallgraph2==1.1.3",
    "gitpython>=3.1.41",
    "pre-commit-hooks==4.6.0",
    "detect-secrets==1.5.0",
    
    # Monitoring & Logging
    "loguru==0.7.2",
    "sentry-sdk==2.5.1",
    "structlog==24.2.0",
]

# intel-gpu = [
#     # Intel GPU acceleration packages
#     # These will be installed via custom index URLs
#     "torch==2.7.0",
#     "torchvision==0.22.0", 
#     "torchaudio==2.7.0",
#     "intel-extension-for-pytorch==2.7.10+xpu",
# ]

[project.urls]
"Homepage" = "https://github.com/zacharyflint/intellicrack"
"Bug Tracker" = "https://github.com/zacharyflint/intellicrack/issues"
"Documentation" = "https://intellicrack.readthedocs.io"
"Source Code" = "https://github.com/zacharyflint/intellicrack"

# Tool configurations

[project.scripts]
intellicrack = "intellicrack.main:main"
intellicrack-cli = "intellicrack.scripts.run_analysis_cli:main"

[project.gui-scripts]
intellicrack-gui = "intellicrack.ui.main_app:launch"

# Tool configurations
[tool.setuptools]
packages = [
    "intellicrack",
    "intellicrack.ai",
    "intellicrack.core",
    "intellicrack.core.analysis",
    "intellicrack.core.anti_analysis",
    "intellicrack.core.c2",
    "intellicrack.core.exploitation",
    "intellicrack.core.mitigation_bypass",
    "intellicrack.core.network",
    "intellicrack.core.patching",
    "intellicrack.core.processing",
    "intellicrack.core.protection_bypass",
    "intellicrack.core.reporting",
    "intellicrack.core.shared",
    "intellicrack.core.vulnerability_research",
    "intellicrack.hexview",
    "intellicrack.models",
    "intellicrack.plugins",
    "intellicrack.plugins.custom_modules",
    "intellicrack.ui",
    "intellicrack.ui.dialogs",
    "intellicrack.ui.widgets",
    "intellicrack.utils",
    "intellicrack.utils.analysis",
    "intellicrack.utils.binary",
    "intellicrack.utils.core",
    "intellicrack.utils.exploitation",
    "intellicrack.utils.patching",
    "intellicrack.utils.protection",
    "intellicrack.utils.reporting",
    "intellicrack.utils.runtime",
    "intellicrack.utils.system",
    "intellicrack.utils.templates",
    "intellicrack.utils.tools",
    "intellicrack.utils.ui",
]
include-package-data = true

[tool.setuptools.package-data]
intellicrack = [
    "assets/*",
    "data/signatures/*",
    "data/templates/*",
    "plugins/custom_modules/*.py",
    "models/*.pkl",
    "models/*.joblib",
    "config/*.json",
]

[tool.pytest.ini_options]
minversion = "7.0"
testpaths = ["tests"]
addopts = [
    "-ra",
    "--strict-markers",
    "--cov=intellicrack",
    "--cov-report=term-missing",
    "--cov-report=html",
    "--cov-report=xml",
]
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]

[tool.coverage.run]
source = ["intellicrack"]
omit = [
    "*/tests/*",
    "*/test_*",
    "*/__init__.py",
    "*/setup.py",
]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __repr__",
    "raise AssertionError",
    "raise NotImplementedError",
    "if __name__ == .__main__.:",
    "if TYPE_CHECKING:",
]

[tool.black]
line-length = 100
target-version = ['py310', 'py311', 'py312']
include = '\.pyi?$'
extend-exclude = '''
/(
  # Directories
  \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
  | ghidra
)/
'''

[tool.isort]
profile = "black"
line_length = 100
multi_line_output = 3
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
ensure_newline_before_comments = true

[tool.mypy]
python_version = "3.10"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = false
disallow_incomplete_defs = false
check_untyped_defs = false
disallow_untyped_decorators = false
no_implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
warn_unreachable = true
strict_equality = true

[tool.pylint.messages_control]
disable = [
    "C0103",  # Invalid name
    "C0114",  # Missing module docstring
    "C0115",  # Missing class docstring
    "C0116",  # Missing function docstring
    "R0903",  # Too few public methods
    "R0912",  # Too many branches
    "R0913",  # Too many arguments
    "R0914",  # Too many local variables
    "R0915",  # Too many statements
    "W0511",  # TODO comments
]

[tool.ruff]
line-length = 100
target-version = "py310"
exclude = [
    "tests/",
    "dev/",
    ".git/",
    ".venv/",
    "venv/",
    "build/",
    "dist/",
    "*.egg-info/",
]

[tool.ruff.lint]
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "C90", # mccabe
    "N",   # pep8-naming
    "B",   # flake8-bugbear
    "S",   # flake8-bandit
]
ignore = [
    "E501",  # Line too long
    "B008",  # Do not perform function calls in argument defaults
    "S101",  # Use of assert detected
]

[tool.bandit]
exclude_dirs = ["tests", "docs"]
skips = ["B101", "B601"]